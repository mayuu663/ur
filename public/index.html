<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>çˆ†ã‚¢ãƒ‰ã‚¸ãƒ£ãƒ³ãƒ—ã‚²ãƒ¼ãƒ </title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      padding-top: 60px;
      background: #fff8fc;
    }

    #character {
      width: 300px;
      transition: transform 0.2s ease;
    }

    .jumping {
      transform: translateY(-30px);
    }

    #score, #timer {
      font-size: 1.8rem;
      margin: 10px;
    }

    #bakuaado {
      position: fixed;
      top: 30%;
      left: 50%;
      transform: translateX(-50%);
      font-size: 3rem;
      font-weight: bold;
      background: linear-gradient(90deg, red, orange, yellow, green, cyan, blue, violet);
      background-clip: text;
      -webkit-background-clip: text;
      color: transparent;
      text-shadow: 0 0 20px rgba(255,255,255,0.9);
      opacity: 0;
      transition: opacity 0.3s ease;
      z-index: 9999;
      pointer-events: none;
    }

    #bakuaado.show {
      opacity: 1;
      animation: boom 0.6s ease alternate infinite;
    }

    @keyframes boom {
      0% { transform: translate(-50%, -10px) scale(1); }
      100% { transform: translate(-50%, 10px) scale(1.05); }
    }

    button {
      font-size: 16px;
      padding: 15px 30px;
      margin-top: 20px;
      border-radius: 12px;
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
    }

    #title {
      font-size: 1.5rem;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h1 id="username">@èª­ã¿è¾¼ã¿ä¸­...</h1>
  <div id="timer">æ®‹ã‚Š: 30ç§’</div>
  <img id="character" src="https://cdn.glitch.global/cb9802f0-cf75-450e-8d7f-d270c4ff372d/idol-stand.PNG?v=1743528514014" alt="ã‚¢ã‚¤ãƒ‰ãƒ«" />
  <p id="score">ã‚¹ã‚³ã‚¢: 0</p>
  <button id="tap" disabled>ã‚¹ã‚¿ãƒ¼ãƒˆã‚’æŠ¼ã—ã¦ã­</button>
  <br><br>
  <button id="start">ã‚¹ã‚¿ãƒ¼ãƒˆï¼</button>
  <div id="title"></div>
  <div id="bakuaado">çˆ†ã‚¢ãƒ‰ï¼ï¼</div>

  <audio id="jumpSound" src="https://cdn.glitch.global/cb9802f0-cf75-450e-8d7f-d270c4ff372d/jump-sound.mp3?v=1743533179006" preload="auto"></audio>
  <audio id="boomSound" src="https://cdn.glitch.global/cb9802f0-cf75-450e-8d7f-d270c4ff372d/boom-sound.mp3?v=1743533164710" preload="auto"></audio>

  <script type="module">
    let score = 0;
    let timeLeft = 30;
    let timerInterval = null;

    window.addEventListener('DOMContentLoaded', async () => {
      let username = '@Anonymous';
      try {
        const { sdk } = window.farcaster;
        const context = await sdk.getContext();
        username = `@${context?.user?.username ?? 'Anonymous'}`;
        console.log('Farcaster context:', context);
      } catch (e) {
        console.log('Farcaster contextå–å¾—å¤±æ•—ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ãƒ†ã‚¹ãƒˆç”¨ï¼‰');
      }
      document.getElementById('username').textContent = username;

      const character = document.getElementById('character');
      const scoreDisplay = document.getElementById('score');
      const button = document.getElementById('tap');
      const timerDisplay = document.getElementById('timer');
      const startBtn = document.getElementById('start');
      const jumpSound = document.getElementById('jumpSound');
      const boomSound = document.getElementById('boomSound');
      const baku = document.getElementById('bakuaado');
      const title = document.getElementById('title');

      const standImg = "https://cdn.glitch.global/cb9802f0-cf75-450e-8d7f-d270c4ff372d/idol-stand.PNG?v=1743528514014";
      const jumpImg = "https://cdn.glitch.global/cb9802f0-cf75-450e-8d7f-d270c4ff372d/dol-jump.PNG?v=1743528505524";

      button.addEventListener('click', () => {
        if (timeLeft <= 0) return;

        score++;
        scoreDisplay.textContent = `ã‚¹ã‚³ã‚¢: ${score}`;
        character.src = jumpImg;
        character.classList.add('jumping');

        jumpSound.currentTime = 0;
        jumpSound.play();

        if (score % 10 === 0) {
          baku.classList.add('show');
          boomSound.currentTime = 0;
          boomSound.play();
          setTimeout(() => baku.classList.remove('show'), 1200);
        }

        setTimeout(() => {
          character.src = standImg;
          character.classList.remove('jumping');
        }, 200);
      });

      startBtn.addEventListener('click', () => {
        score = 0;
        timeLeft = 30;
        scoreDisplay.textContent = 'ã‚¹ã‚³ã‚¢: 0';
        timerDisplay.textContent = 'æ®‹ã‚Š: 30ç§’';
        button.disabled = false;
        button.textContent = "ã‚¸ãƒ£ãƒ³ãƒ—ï¼";
        startBtn.disabled = true;
        title.textContent = '';

        timerInterval = setInterval(() => {
          timeLeft--;
          timerDisplay.textContent = `æ®‹ã‚Š: ${timeLeft}ç§’`;
          if (timeLeft <= 0) {
            clearInterval(timerInterval);
            button.disabled = true;
            button.textContent = "çµ‚äº†ï¼";
            startBtn.disabled = false;
            timerDisplay.textContent = `çµ‚äº†ï¼`;

            // ç§°å·åˆ¤å®š
            let message = '';
            if (score >= 50) {
              message = 'ğŸ‘‘ çˆ†ã‚¢ãƒ‰ã‚¸ãƒ£ãƒ³ãƒ—ç¥ï¼ï¼';
            } else if (score >= 40) {
              message = 'ğŸ’« å¤©æ‰ã‚¸ãƒ£ãƒ³ãƒ—ãƒã‚¹ã‚¿ãƒ¼ï¼';
            } else if (score >= 30) {
              message = 'ğŸ’ª ã‚¸ãƒ£ãƒ³ãƒ—è·äººï¼';
            } else if (score >= 20) {
              message = 'ğŸŒŸ ãã“ãã“é£›ã¹ã‚‹ãƒãƒ³';
            } else if (score >= 10) {
              message = 'âœ¨ è¦‹ç¿’ã„ã‚¸ãƒ£ãƒ³ãƒ‘ãƒ¼';
            } else {
              message = 'ğŸ¥š ãƒ˜ãƒŠãƒãƒ§ã‚³ã‚¢ã‚¤ãƒ‰ãƒ«å€™è£œç”Ÿ';
            }
            title.textContent = `ã‚ãªãŸã®ç§°å·ï¼š${message}`;
          }
        }, 1000);
      });
    });
  </script>
</body>
</html>
